<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fetch API playground</title>
  </head>
  <body>
    <button id="get-text">Get Text</button>
    <button id="get-superheroes">Get JSON</button>
    <button id="get-posts">Get API data</button>
    <hr>
    <form id='add-post'>
        <div>
            <input type='text' id='title' placeholder='Title'>
        </div>
        <div>
            <textarea id="body" placeholder='Body'></textarea>
        </div>
        <div>
            <input type='submit' value='Submit'></input>
        </div>
    </form>
    <div id="output"></div>

    <script>
      document.getElementById('get-text').addEventListener('click', getText);
      document.getElementById('get-superheroes').addEventListener('click', getSuperheroes);
      document.getElementById('get-posts').addEventListener('click', getPosts);
      document.getElementById('add-post').addEventListener('click', addPost);

      // Gets data from text file
      function getText() {
        fetch('sample.txt')
          .then((res) => {
            return res.text();
          })
          .then((data) => {
            // console.log(data);
            document.getElementById('output').innerHTML = data;
          })
          .catch((err) => console.log(err));
      }

      // Gets data from JSON file
      function getSuperheroes() {
        fetch('superheroes.json')
          .then((res) => {
            return res.json();
          })
          .then((data) => {
            console.log(data);
            let output = `<h2>Superheroes</h2>`;
            data.forEach((hero) => {
              output += `
                <ul>
                    <li>ID: ${hero.id}</li>
                    <li>Name: ${hero.name}</li>
                    <li>Email: ${hero.email}</li>
                </ul>
                `;
            });
            document.getElementById('output').innerHTML = output;
          });
      }

     // Gets data from API 
      function getPosts() {
        fetch('https://jsonplaceholder.typicode.com/posts')
          .then((res) => {
            return res.json();
          })
          .then((data) => {
            console.log(data);
            let output = `<h2>Posts</h2>`;
            data.forEach((post) => {
              output += `
                    <div>
                        <h3>${post.title}</h3>
                        <p>${post.body}<p>
                    </div> `;
            });
            document.getElementById('output').innerHTML = output;
          });
      }


    function addPost(e) {
        e.preventDefault(); // prevent submitting
        // get the values from the title and body form fields
        let title = document.getElementById('title').value;
        let body = document.getElementById('body').value;

        fetch('https://jsonplaceholder.typicode.com/posts', {
             method: 'POST', 
             headers: {
                'Accept': 'application/json, text/plain, */*', 
                'Content-type': 'application/json'
             },
             body:JSON.stringify({title: title, body:body})// convert to a string before sending data back
          })
          .then((res) => res.json())
          .then((data) => console.log(data));
       }
    </script>
  </body>
</html>
